

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>HTTP in Python with requests &mdash; Python Training 0.2 documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="Python Training 0.2 documentation" href="index.html"/>
        <link rel="next" title="Working with APIs" href="api.html"/>
        <link rel="prev" title="Regular expressions" href="regular_expressions.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Python Training
          

          
          </a>

          
            
            
              <div class="version">
                0.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="environment.html">Environment configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="project_structure.html">Project structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="strings.html">String formatting</a></li>
<li class="toctree-l1"><a class="reference internal" href="builtins.html">Built-in types - good practices</a></li>
<li class="toctree-l1"><a class="reference internal" href="files.html">Working with files</a></li>
<li class="toctree-l1"><a class="reference internal" href="regular_expressions.html">Regular expressions</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">HTTP in Python with <code class="docutils literal"><span class="pre">requests</span></code></a><ul>
<li class="toctree-l2"><a class="reference internal" href="#short-intro-to-http">Short intro to HTTP</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#what-is-an-http-request">What is an HTTP request?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#http-request-methods">HTTP request methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="#http-response">HTTP Response</a></li>
<li class="toctree-l3"><a class="reference internal" href="#response-status-codes">Response status codes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#requests-module"><code class="docutils literal"><span class="pre">requests</span></code> module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#sending-a-simple-get-request">Sending a simple GET request</a></li>
<li class="toctree-l3"><a class="reference internal" href="#authentication">Authentication</a></li>
<li class="toctree-l3"><a class="reference internal" href="#request-parameters">Request parameters</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#excercise-req00-basic-http-authentication">Excercise REQ00: Basic HTTP Authentication</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#tasks">Tasks</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#excercise-req01-exploiting-a-blind-sql-injection-vulnerability">Excercise REQ01: Exploiting a Blind SQL Injection vulnerability</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#what-is-an-sql-injection">What is an SQL Injection?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#blind-sql-injection">Blind SQL Injection</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sql-like-operator">SQL LIKE operator</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sql-binary-operator">SQL BINARY operator</a></li>
<li class="toctree-l4"><a class="reference internal" href="#malicious-query">Malicious query</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id1">Tasks</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#excercise-req02-brute-force-attack-on-session-id">Excercise REQ02: Brute force attack on session id</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#what-is-a-session-id">What is a session ID?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2">Tasks</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">Working with APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="arguments.html">*args and **kwargs</a></li>
<li class="toctree-l1"><a class="reference internal" href="classes.html">Classes and Object Oriented Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="gotchas.html">Common Python gotchas</a></li>
<li class="toctree-l1"><a class="reference internal" href="decorators.html">Decorators</a></li>
<li class="toctree-l1"><a class="reference internal" href="lambda.html">Lambda expressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="magic_methods.html">Magic methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="docs.html">Creating documentation with <code class="docutils literal"><span class="pre">Sphinx</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="solutions.html">Solutions</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Python Training</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>HTTP in Python with <code class="docutils literal"><span class="pre">requests</span></code></li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/requests.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="http-in-python-with-requests">
<h1>HTTP in Python with <a class="reference external" href="http://docs.python-requests.org/en/master/api/#module-requests" title="(in Requests v2.18.1)"><code class="xref py py-mod docutils literal"><span class="pre">requests</span></code></a><a class="headerlink" href="#http-in-python-with-requests" title="Permalink to this headline">¶</a></h1>
<div class="section" id="short-intro-to-http">
<h2>Short intro to HTTP<a class="headerlink" href="#short-intro-to-http" title="Permalink to this headline">¶</a></h2>
<p>Each time a browser needs to fetch a file from a server it uses a protocol called HTTP (HyperText Transfer Protocol).
In HTTP the client sends a request for some resource and receives a response from the server with information about the resource and the resoure itself.</p>
<div class="section" id="what-is-an-http-request">
<h3>What is an HTTP request?<a class="headerlink" href="#what-is-an-http-request" title="Permalink to this headline">¶</a></h3>
<p>The basic structure of an HTTP request is the following:</p>
<blockquote>
<div><ol class="arabic simple">
<li>A Request-line consisting the request method</li>
<li>Zero or more header lines followed by a CRLF (end of the line characters basically)</li>
<li>An empty line indicating the end of the request’s header</li>
<li>Optionally a message-body</li>
</ol>
</div></blockquote>
<p>Example GET request sent to google.com from Firefox browser:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>GET /v3/links/fetch/en-US/default HTTP/1.1
Host: tiles.services.mozilla.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:45.0) Gecko/20100101 Firefox/45.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: application/json
Connection: close
</pre></div>
</div>
<p>The body of the above request is empty.</p>
</div>
<div class="section" id="http-request-methods">
<h3>HTTP request methods<a class="headerlink" href="#http-request-methods" title="Permalink to this headline">¶</a></h3>
<p>HTTP requests use different methods to indicate the operation to be performed on the requested resource. The most commonly used are:</p>
<ol class="arabic">
<li><p class="first">GET</p>
<blockquote>
<div><p>The GET method is used to retrieve information from the given server using a given URI. Requests using GET should only retrieve data and should have no other effect on the data.</p>
</div></blockquote>
</li>
<li><p class="first">POST</p>
<blockquote>
<div><p>A POST request is used to send data to the server, for example, customer information, file upload, etc. using HTML forms.</p>
</div></blockquote>
</li>
<li><p class="first">PUT</p>
<blockquote>
<div><p>Replaces all the current representations of the target resource with the uploaded content.</p>
</div></blockquote>
</li>
<li><p class="first">DELETE</p>
<blockquote>
<div><p>Removes all the current representations of the target resource given by URI.</p>
</div></blockquote>
</li>
</ol>
</div>
<div class="section" id="http-response">
<h3>HTTP Response<a class="headerlink" href="#http-response" title="Permalink to this headline">¶</a></h3>
<p>HTTP Response has the following structure:</p>
<blockquote>
<div><ol class="arabic simple">
<li>A Status-line</li>
<li>Zero or more header fields followed by CRLF (end of line charachters)</li>
<li>An empty line</li>
<li>Optionally a message-body</li>
</ol>
</div></blockquote>
<p>In case of HTTP requests sent by a browser, the message body typically contains the HTML code of the requested web page.</p>
</div>
<div class="section" id="response-status-codes">
<h3>Response status codes<a class="headerlink" href="#response-status-codes" title="Permalink to this headline">¶</a></h3>
<p>Status code of a response is a 3-digit integer, where the first digit indicates the category of the response:</p>
<dl class="docutils">
<dt>1       1xx: Informational</dt>
<dd>It means the request was received and the process is continuing.</dd>
<dt>2       2xx: Success</dt>
<dd>It means the action was successfully received, understood, and accepted.</dd>
<dt>3       3xx: Redirection</dt>
<dd>It means further action must be taken in order to complete the request.</dd>
<dt>4       4xx: Client Error</dt>
<dd>It means the request contains incorrect syntax or cannot be fulfilled.</dd>
<dt>5       5xx: Server Error</dt>
<dd>It means the server failed to fulfill an apparently valid request.</dd>
</dl>
<p>Successful requests have typically the status code 200, the status 404 indicates that the requested resource has not been found.</p>
</div>
</div>
<div class="section" id="requests-module">
<h2><a class="reference external" href="http://docs.python-requests.org/en/master/api/#module-requests" title="(in Requests v2.18.1)"><code class="xref py py-mod docutils literal"><span class="pre">requests</span></code></a> module<a class="headerlink" href="#requests-module" title="Permalink to this headline">¶</a></h2>
<p>To work with HTTP requests we will use the third-party library <a class="reference external" href="http://docs.python-requests.org/en/master/api/#module-requests" title="(in Requests v2.18.1)"><code class="xref py py-mod docutils literal"><span class="pre">requests</span></code></a>.
It’s not a part of the standard library, but currently it’s the standard way to go about HTTP with Python.</p>
<p>It can be installed with pip by typing:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>python3 -m pip install requests
</pre></div>
</div>
<p>or</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>pip install requests
</pre></div>
</div>
<p>if pip for the right version of python is available in your PATH</p>
<p>Try to install <a class="reference external" href="http://docs.python-requests.org/en/master/api/#module-requests" title="(in Requests v2.18.1)"><code class="xref py py-mod docutils literal"><span class="pre">requests</span></code></a> within your virtual environment only.</p>
<div class="section" id="sending-a-simple-get-request">
<h3>Sending a simple GET request<a class="headerlink" href="#sending-a-simple-get-request" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;http://www.python.org&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="authentication">
<h3>Authentication<a class="headerlink" href="#authentication" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="http://docs.python-requests.org/en/master/api/#module-requests" title="(in Requests v2.18.1)"><code class="xref py py-mod docutils literal"><span class="pre">requests</span></code></a> support a wide variety of authentication methods. For the training we will need only the basic HTTP Authentication</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">requests.auth</span> <span class="kn">import</span> <span class="n">HTTPBasicAuth</span>

<span class="n">auth</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;my_username&#39;</span><span class="p">,</span> <span class="s1">&#39;my_password&#39;</span><span class="p">)</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">URL</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="n">auth</span><span class="p">)</span>
</pre></div>
</div>
<p>Go to <a class="reference internal" href="#req00"><span class="std std-ref">Excercise REQ00: Basic HTTP Authentication</span></a></p>
</div>
<div class="section" id="request-parameters">
<h3>Request parameters<a class="headerlink" href="#request-parameters" title="Permalink to this headline">¶</a></h3>
<p>HTTP requests can have additional parameters, used for example for sending data from user forms.</p>
<p>For example, if a login page has uses the following form:</p>
<div class="highlight-html"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">form</span> <span class="na">action</span><span class="o">=</span><span class="s">&quot;index.php&quot;</span> <span class="na">method</span><span class="o">=</span><span class="s">&quot;POST&quot;</span><span class="p">&gt;</span>
    Username: <span class="p">&lt;</span><span class="nt">input</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;username&quot;</span><span class="p">&gt;&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
    Password: <span class="p">&lt;</span><span class="nt">input</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;password&quot;</span><span class="p">&gt;&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;submit&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;Login&quot;</span> <span class="p">/&gt;</span>
<span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>You can generate a corresponding request by using POST method with username and password provided in params dictionary</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">my_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;username&#39;</span><span class="p">:</span><span class="s1">&#39;my_username&#39;</span><span class="p">,</span> <span class="s1">&#39;password&#39;</span><span class="p">:</span><span class="s1">&#39;my_password&#39;</span><span class="p">}</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">URL</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">my_params</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="excercise-req00-basic-http-authentication">
<span id="req00"></span><h2>Excercise REQ00: Basic HTTP Authentication<a class="headerlink" href="#excercise-req00-basic-http-authentication" title="Permalink to this headline">¶</a></h2>
<div class="section" id="tasks">
<h3>Tasks<a class="headerlink" href="#tasks" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>Send a GET request to one of LSYP intranet pages. Use <code class="docutils literal"><span class="pre">HTTPBasicAuth</span></code> object to to provide your credentials.</li>
<li>You can store them temporarily in an external module and import to your script as variables or get from the user with <code class="xref py py-func docutils literal"><span class="pre">input()</span></code></li>
</ol>
<p><a class="reference internal" href="solutions_proxy.html#req00-solution"><span class="std std-ref">Solution to REQ00</span></a></p>
</div>
</div>
<div class="section" id="excercise-req01-exploiting-a-blind-sql-injection-vulnerability">
<h2>Excercise REQ01: Exploiting a Blind SQL Injection vulnerability<a class="headerlink" href="#excercise-req01-exploiting-a-blind-sql-injection-vulnerability" title="Permalink to this headline">¶</a></h2>
<p>The service <a class="reference external" href="http://overthewire.org/wargames/">http://overthewire.org/wargames/</a> offers a large set of so called wargames, i.e. challenges that help you to learn and practice various IT-security concepts.</p>
<p>The series “natas” concentrates on web applications. To enter each of the levels you need a password that is obtained by solving the previous puzzle.
Today we will solve the level 16 which deals with the vulnerability called Blind SQL Injection</p>
<div class="section" id="what-is-an-sql-injection">
<h3>What is an SQL Injection?<a class="headerlink" href="#what-is-an-sql-injection" title="Permalink to this headline">¶</a></h3>
<p>According to Wikipedia:</p>
<blockquote class="pull-quote">
<div><p>SQL injection is a code injection technique, used to attack data-driven applications,in which nefarious SQL statements are inserted into an entry field for execution.</p>
<p>It is mostly known as an attack vector for websites but can be used to attack any type of SQL database.</p>
</div></blockquote>
<p>Practically, if a web application contains an entry field, from which the str  ing is directly put into an SQL query,
there is a risk, that the user would escape the query and execute some logic or operations that were not originally intended by the author of the application.</p>
<p>Let’s consider the following query:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">statement</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM users WHERE name = &#39;&quot;</span> <span class="o">+</span> <span class="n">userName</span> <span class="o">+</span> <span class="s2">&quot;&#39;;&quot;</span>
</pre></div>
</div>
<p>If the following string is inserted into this query without any validation or character escapes</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>&#39; OR &#39;1&#39;=&#39;1
</pre></div>
</div>
<p>the “WHERE” section of the query will always return True, and thus - the results of the SELECT will be returned no matter what the original condition was (in this case that the username must be known)</p>
</div>
<div class="section" id="blind-sql-injection">
<h3>Blind SQL Injection<a class="headerlink" href="#blind-sql-injection" title="Permalink to this headline">¶</a></h3>
<p>Not always the result of a SELECT query are printed directly to on the website. Sometimes it’s only some other information like whether or not a user with the given username exists.
In such case we can obtain the sensitive information indirectly by exploiting the so called Blind SQL Injection.</p>
<p>The vulnerable webpage from natas15 uses the following PHP code for executing the query:</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
    <span class="c1"># (...)</span>
    <span class="nv">$query</span> <span class="o">=</span> <span class="s2">&quot;SELECT * from users where username=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s2">&quot;username&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">array_key_exists</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="nv">$_GET</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">&quot;Executing query: </span><span class="si">$query</span><span class="s2">&lt;br&gt;&quot;</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nv">$res</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$query</span><span class="p">,</span> <span class="nv">$link</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="nv">$res</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">mysql_num_rows</span><span class="p">(</span><span class="nv">$res</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">&quot;This user exists.&lt;br&gt;&quot;</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">&quot;This user doesn&#39;t exist.&lt;br&gt;&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">&quot;Error in query.&lt;br&gt;&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="c1"># (...)</span>
<span class="cp">?&gt;</span><span class="x"></span>
</pre></div>
</div>
<p>As we can see, the “username” variable is inserted directly from the POST request and that creates an SQL injection vulnerability.
However the results of the query to the database are not printed anywhere.</p>
<p>Is the information that the given user exists enough to obtain his password?</p>
<div class="section" id="sql-like-operator">
<h4>SQL LIKE operator<a class="headerlink" href="#sql-like-operator" title="Permalink to this headline">¶</a></h4>
<p>The LIKE operator is used in a WHERE clause to search for a specified pattern in a column.</p>
<p>The following SQL statement selects all customers with a City starting with the letter “s”:
Example:</p>
<div class="highlight-sql"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">Customers</span>
<span class="k">WHERE</span> <span class="n">City</span> <span class="k">LIKE</span> <span class="s1">&#39;s%&#39;</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="sql-binary-operator">
<h4>SQL BINARY operator<a class="headerlink" href="#sql-binary-operator" title="Permalink to this headline">¶</a></h4>
<p>In the considered scenario, LIKE will check the pattern case-insensitively (will return true both when the password starts with A or a, regardless the case)
Use LIKE BINARY to get a case-sensitive results.</p>
</div>
<div class="section" id="malicious-query">
<h4>Malicious query<a class="headerlink" href="#malicious-query" title="Permalink to this headline">¶</a></h4>
<p>By combining the original query that checks if the user exists with the additional condition on the password, we can create an injection that will result in the text “This user exists”
displayed only if the user exists AND its password starts with the given letter.</p>
</div>
</div>
<div class="section" id="id1">
<h3>Tasks<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>Write a Python script that will find the password for the user natas16</li>
<li>Assume that the password is 32 characters long and contains numbers and upper and lower case letters.</li>
<li>Use Blind SQL injection with LIKE BINARY operator to check if the user’s password starts with some letter.</li>
<li>After each request check if the response contains the expected text, “This user exists.”</li>
<li>If a single check is successful, move on trying to guess the next letter.</li>
<li>Print the whole password on the screen and try to login to the next level.</li>
</ol>
</div>
</div>
<div class="section" id="excercise-req02-brute-force-attack-on-session-id">
<h2>Excercise REQ02: Brute force attack on session id<a class="headerlink" href="#excercise-req02-brute-force-attack-on-session-id" title="Permalink to this headline">¶</a></h2>
<p>This example is another level from natas wargame.
In this excercise we will hijack a session by executing a brute force attack on the session id.</p>
<p>We assume that on the server there already exists an authenticated admin session and once we send a request with its id, the password to the next level will be revealed.</p>
<div class="section" id="what-is-a-session-id">
<h3>What is a session ID?<a class="headerlink" href="#what-is-a-session-id" title="Permalink to this headline">¶</a></h3>
<p>A session ID in network communication is a piece of data used to identify a series of related message exchanges between the client and the server.
A Session ID is used to identify a logged in user and thus, when stolen, can be used to obtain the user’s privileges.
In real systems, session ids are long, randomly generated values to prevent session hijacking by guessing or brute force attacks.</p>
<p>However in this excercise we will simulate an attack on a website that grants session ids as random numbers from a very limited pool.</p>
<p>In PHP session id is stored read from a cookie value <code class="docutils literal"><span class="pre">PHPSESSID</span></code>.</p>
<p>To send a cookie with <a class="reference external" href="http://docs.python-requests.org/en/master/api/#module-requests" title="(in Requests v2.18.1)"><code class="xref py py-mod docutils literal"><span class="pre">requests</span></code></a>, use cookies parameter:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>

<span class="c1"># (...)</span>

<span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">URL</span><span class="p">,</span> <span class="n">cookies</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;cookie_name&#39;</span><span class="p">:</span> <span class="s1">&#39;cookie_value&#39;</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="id2">
<h3>Tasks<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>level: <a class="reference external" href="http://natas18.natas.labs.overthewire.org">http://natas18.natas.labs.overthewire.org</a></p>
<p><code class="docutils literal"><span class="pre">username:</span> <span class="pre">natas18</span></code></p>
<p><code class="docutils literal"><span class="pre">password:</span> <span class="pre">xvKIqDjy4OPv7wCRgDlmj0pFsCsDjhdP</span></code></p>
<ol class="arabic simple">
<li>Open <code class="docutils literal"><span class="pre">natas18</span></code> in the browser, examine the webpage, check the source and see what data is exchanged with the server (by looking at the name of the input field in the page source)</li>
<li>Use Python requests to send a request to the website and print the response</li>
<li>Brute force the session id by sending requests with different values of the cookie, assume that the <code class="docutils literal"><span class="pre">PHPSESSID</span></code> value is an integer.</li>
<li>Look for a response that reveals the password. Assume that you know that the password is a 32 characters long string of numbers and letters</li>
<li>Extract the password from the response and print it on the screen (use regular expressions!)</li>
</ol>
<p><a class="reference internal" href="solutions_proxy.html#req02-solution"><span class="std std-ref">Solution to REQ02</span></a></p>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="api.html" class="btn btn-neutral float-right" title="Working with APIs" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="regular_expressions.html" class="btn btn-neutral" title="Regular expressions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Piotr Baranowski.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.2',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>